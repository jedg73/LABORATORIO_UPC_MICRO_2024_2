#include <stdlib.h>
#include <stdio.h>
#include <pic18f57q43.h>
#include <xc.h>
#include "cabzon.h"
#include "teclado.h"
#include "LCD.h"

#define _XTAL_FREQ 4000000UL

void configuro();
void LCD_init();

void main(void)
{
    configuro();
    teclado_init();
    LCD_init();
    
    POS_CURSOR(1, 6);
    ESCRIBE_MENSAJE("UPC", 3);
    
    char tecla = 0;
    
    while(1)
    {
        tecla = teclado_getc();
        if (tecla != 0)
        {
            if (tecla == '3')
            {
                POS_CURSOR(2, 5);
                ESCRIBE_MENSAJE("3", 1);  // Muestra '3' en la LCD
            }
        }
    }
}

void configuro()
{
    OSCCON1 = 0x60;  // HFINTOSC
    OSCFRQ = 0x02;   // HFINTOSC a 4MHz
    OSCEN = 0x40;    // Habilitar HFINTOSC
    TRISD = 0x00;    // Puerto D como salida
    ANSELD = 0x00;   // Puerto D como digital
    
    TRISB = 0xF0;    // Puerto B como entrada/salida
    ANSELB = 0x00;   // Puerto B como digital
    WPUB = 0xF0;     // Pull-ups en el puerto B
}

void LCD_init()
{
    __delay_ms(29);   // Retardo inicial para estabilizar
    LCD_CONFIG();     // Configuraci√≥n del LCD
    BORRAR_LCD();     // Limpiar el LCD
    CURSOR_HOME();    // Llevar el cursor al inicio
    CURSOR_ONOFF(OFF); // Apagar el cursor para evitar parpadeo
}
// EL CODIGO FUNCIONARA LUEGO DE ACTIVAR EL RESET
